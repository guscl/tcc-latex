\chapter{Aprendizado de Máquina}


AM pode ser altamente benéfico para solução de problemas complexos, é possível observar um ciclo de trabalho bem definido que está presente na solução de problemas por uma abordagem de Aprendizado de Máquina. As etapas gerais de projetos de AM são aquisição de dados, construção de modelo, análise, otimização e predição. Com estas cinco etapas é possível sair de um conjunto de dados e chegar as respostas desejadas através de cuidadosa seleção e processamento de dados. Passando pela construção e avaliação de um método eficaz até chegar a um modelo consistente com a necessidade do problema. Embora haja uma linearidade na execução desses processos é comum em projetos de AM revisitar estas etapas várias vezes. A imagem a seguir revela um ciclo de AM mais detalhado e que engloba as etapas previamente citadas ressaltando elementos importantes  \cite{real2013}: 

\begin{figure}[!h]
\centering
\includegraphics[keepaspectratio=true,scale=0.50]
{figuras/workflowml.eps}
\caption{Fluxo de Trabalho de AM}
\label{workflow_am}
\end{figure}

Este capítulo serve para detalhar os processos AM. A figura anterior mostra os ciclos de trabalho que acontecem até que o modelo esteja satisfatório com as expectativas de performance. Várias etapas podem ser repetidas até que o modelo esteja refinado o suficiente. A área central que corresponde a construção do modelo pode levar várias iterações e, as vezes, é necessário rever até mesmo a primeira etapa do ciclo, Aquisição dos Dados. As próximas seções deste capítulo seguem os processos descritos no fluxo de trabalho de AM.

\begin{enumerate}
\item Aquisição dos dados
\item Engenharia de Características
\item Construção do modelo
\item Avaliação do modelo
\item Otimização do modelo
\item Predições
\end{enumerate}

\section{Aquisição dos dados}
Apesar de parecer trivial, definir a aquisição de dados como uma etapa do projeto de AM é extremamente importante e alguns cuidados especiais devem ser considerados para que as predições tenham um bom desempenho. O primeiro passo antes de começar o projeto de AM é saber qual a necessidade do mundo real que deve ser atendida. Este passo pode ser entendido como a necessidade de encontrar questões que envolvem uma variável de interesse (quem gostaria de comprar este produto, qual o significado deste áudio em linguagem natural, onde está a face humana nesta imagem,...) e o caminho pra solução que envolve variáveis independentes (histórico de compras dos usuários, mapeamento de sons para texto, características de faces humanas).

Nem sempre utilizar Aprendizagem de Máquina é a melhor resposta para solucionar os problemas do mundo real. É necessário avaliar com cuidado quais os objetivos da solução e qual o contexto do problema. Um grande indício de que o problema pode ser solucionado por AM é se ele possui algumas das seguintes características: Alta complexidade entre entradas e saídas, grande volume de dados, necessidade de generalização e necessidade de adaptabilidade a novos cenários. 

Os dados que servem como entrada para os processos de modelagem geralmente estão apresentados na forma de tabelas que possuem colunas e linhas. As colunas representam as características dos dados, como se fossem meta-dados, e as linhas representam instâncias dessas características. A tabela a seguir representa os tipos de dados que podem aparecer como característica de dados na Aprendizagem de Máquina \cite{guy2010}.

\begin{table}[h]
\centering
\caption{Tipos de Dados}
\vspace{0.5cm}
\begin{tabular}{r|lr}

\hline 
Tipo & Exemplo  \\ % Note a separação de col. e a quebra de linhas
\hline                               % para uma linha horizontal
Átomo Categórico        & Uma palavra na língua portuguesa \\
\hline   
Átomo Numérico & Valor de temperatura \\
\hline 
Átomo Ordinário           & Preferência cinematográfica (Número de Estrelas) \\
\hline 
Conjunto desordenado de números       & Sinais vitais(pulso, temperatura, pressão sanguínea)\\
\hline 
Conjunto desordenado de misturas     & Informação demográfica(raça, sexo, idade, renda)\\
\hline 
Sequência unidimensional de categóricos       & Documento de texto\\
\hline 
Sequência unidimensional de números       & Série Temporal Financeira\\
\hline 
Sequência bidimensional de números      & Imagem\\
\hline 
Sequência tridimensional de números       & Filme\\
\hline 
Grafo Arbitrário Categórico       & Árvore de Conversões\\
 \hline 
\end{tabular}
\end{table}

A figura a seguir é uma pequena seleção da base de dados que contém informações sobre os passageiros que estavam presentes no naufrágio do Titanic \cite{titanic2012}. 

\begin{figure}[!h]
\centering
\includegraphics[keepaspectratio=true,scale=0.40]
{figuras/dataEg.eps}
\caption{Exemplo de Dados do Titanic}
\label{data_titatic}
\end{figure}

Cada linha corresponde as informações de um passageiro e cada coluna representa um tipo de informação deste passageiro. Esta base de dados foi criada com objetivo de tentar prever, através das informações de um passageiro, se ele sobreviveu ou não ao naufrágio. A base já contém a informação sobre a sobrevivência do passageiro. Muitos modelos são criados com base nas informações deste conjunto de dados, é possível fazer predições sobre a sobrevivência dos passageiros e comparar estes resultados com a informação real que já esta registrada nas tabelas. Por este motivo o conjunto de dados vem sendo usado de forma didática para AM, muitas pessoas o usam para validadar seus modelos e há competições baseadas em predições com esta base \cite{titanic2011}. A enumeração a seguir explica qual o tipo de informação de cada coluna. 

\begin{enumerate}
\item IDPassageiro: Um átomo numérico que identifica unicamente cada passageiro.
\item Sobreviveu: Um átomo numérico que representa se a pessoa sobreviveu ou não ao naufrágio. Assume valor "1" para sobreviventes e "0" para não sobreviventes.
\item Pclasse: Átomo numérico que varia de "1" a "3", representa a classe do passageiro. "1" equivale a primeira classe, "2" a segunda classe e "3" a terceira.
\item Nome: Átomo categórico que representa o nome do passageiro.
\item Sexo: Átomo categórico que representa o sexo do passageiro.
\item Idade: Átomo numérico que representa a idade do passageiro.
\item IrConj: Átomo numérico que representa a soma da quantidade de irmãos e cônjuges do passageiro a bordo.
\item PaiFilh: Átomo numérico que representa a soma da quantidade de pais e filhos do passageiro a bordo.
\item Ticket: Átomo categórico que representa o número do ticket de embarque do passageiro.
\item Taixa: Átomo numérico que representa o preço da passagem paga pelo passageiro.
\item Cabine: Átomo categórico que representa o número da cabine do passageiro.
\item Embarcado: Átomo categórico que representa o porto de embarque do passageiro. "C"  para a cidade de Cherbourg, "Q"  para a cidade de Queesntown e "S"  para Southampton.
\end{enumerate}


É importante notar que nem todos os dados disponíveis são úteis para a resolução do problema. Qual seria a relevância do atributo \textbf{IDPassageiro} na resolução do problema? Este atributo é gerado automaticamente e está relacionado com a ordem dos registros no computador e não com uma característica real do passageiro. A decisão de escolher que dados são úteis para a solução do problema é um trabalho não trivial, que exige conhecimento do contexto do problema e repetidas iterações de otimização. Conhecendo o problema é possível descartar informações que não são relevantes, e tendo um modelo pronto é possível testar se determinada informação afeta ou não a performance da predição. Diminuir a quantidade de informações que entra no modelo pode ajudar no tempo em que as predições são feitas e também na performance do sistema em geral, isto se deve ao fato de que ter informações que não se relacionam com a variável de interesse aumenta o ruído do sistema, a figura 3 demonstra este fluxo de trabalho \cite{real2013}.

\begin{figure}[!h]
\centering
\includegraphics[keepaspectratio=true,scale=0.5]
{figuras/data_workflow.eps}
\caption{Fluxo de Trabalho da Seleção de Características}
\label{workflow_data}
\end{figure}

Se houver dúvida sobre a relação causal entre determinada variável e a saída do sistema é possível realizar duas execuções do modelo: Uma com a variável independente e outra sem. Se não houver melhora na predição esse é um sinal de que a informação pode ser descartada, caso haja queda na precisão, é um indício de que a variável independente tem relação causal com a variável de interesse.

Outro fator relevante na Aquisição de Dados é que a maioria dos modelos só aceitam entradas numéricas ou categóricas. Portanto é necessário transformar outros tipos de dados em entradas ideais por um processo chamado de Engenharia de Características, este processo será descrito a frente \cite{real2013}. 

Como é possível observar na pequena seleção da base de dados do Titanic, coluna 11 (Cabine) da Figura 2, existem algumas linhas que não possuem seu valor preenchido. Esse fenômeno é chamado de Dados Faltantes, do inglês Missing Data. É comum em diversas bases de dados encontrar informações faltantes, isso se deve a diversos motivos, como erro na hora da coleta ou perdas que acontecem com o tempo. Estas informações podem ser decisivas para que o modelo aprenda algum relaciomento novo e de acordo com os autores de \citeonline{anal2003} (em livre tradução) "Um problema relevante na qualidade dos dados é a presença de dados faltantes" e " ... o tratamento de dados faltantes deve ser feito com muito cuidado, de outra forma erro pode ser introduzido no conhecimento aprendido". 

Dados faltantes podem ser encontrados por diversos motivos dentro de uma base de dados, nem todos os motivos estão realaciodos a erros humanos e é importante conhecer a origem de cada tipo de dado faltante para utilizar o método de tratamento correto. A enumeração a seguir demonstra os tipos de Dados Faltantes que podem existir de acordo com \cite{stat1987}.

\begin{enumerate}
\item Missing completely at random (MCAR):Perda completamente ao acaso. É o maior nível de randomicidade. Acontece quando a probabilidade de perda em um caso pode não depender nem dos valores que esse atributo assume nem do dado perdido em si. É naturalmente randômico e qualquer método de tratamento pode ser utilizado sem o risco de introduzir erro no aprendizado.
\item Missing at random (MAR): Perda ao acaso. Quando a probabilidade de perda pode depender dos valores que atributo pode assumir, mas não pode depender do dado perdido em si.
\item Not missing at random (NMAR): Perda ao não acaso. Neste caso pode existir algum motivo real para que a instância esteja perdida. A probabilidade de perde pode depender do valor que a instância do dado assume no momento.
\end{enumerate}

Muitos métodos são propostos para lidar com este problema, ainda de acordo com  R. J. Little e D. B. Rubin apud \citeonline{anal2003}, os métodos de tratamento para dados faltantes se enquandram em uma das três categorias a seguir:

\begin{enumerate}
\item Ignorar e descartar o dado: Consiste em descartar o dados faltantes. A primeira forma de fazer isso é descartar toda a tupla que contém algum dado faltante. Outra forma é avaliar a quantidade de dados faltantes em cada tupla e em cada coluna, depois disso eliminar as instâncias(tupla ou coluna) de acordo com extensão dos dados faltantes. Antes de deletar qualquer tupla ou atributo é necessário analisar a importância desse dado na performace geral do modelo. Atributos que são relevantes devem ser mantidos mesmo se seu nível de perda for muito alto. Este método só deve ser usado quando os dados faltantes são do tipo MCAR.
\item Estimação de Parâmetro: Neste caso todas as instâncias parecidas são analizadas e o dado faltante tem seu valor atribuído com um valor que possui alta similaridade com seus vizinhos.
\item Imputação: Consiste em uma série de métodos que visam atribuir valores faltantes com estimações. Busca-se encontrar relaciomentos entre o sistema e os dados faltantes, pode-se dizer que um novo processo de AM é empregado para estimar estes valores.
\end{enumerate}


\section{Engenharia de Características}
\section{Construção do modelo}
\section{Avaliação do modelo}
\section{Otimização do modelo}
\section{Predições}





Contexto de ML
Justificativa (Número, Big Data, Aprendizado incremental)
Processos de ML (Tipos de pré-processamento)

